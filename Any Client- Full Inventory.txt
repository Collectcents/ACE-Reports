SELECT
account.customer_client_code As "CLIENT NO.",
account.debt_id AS "ACCOUNT NO.",
case when account.company_name is not null then account.company_name else concat(account.last_name,', ',account.first_name,' ',account.middle_name) end AS "CLIENT NAME", -- check out
account.client_account_number AS "CLIENT REFERENCE NUMBER",
client_data.client_ref_1 AS "CLIENT REF1",
client_data.client_ref_2 AS "CLIENT REF2",
client_data.client_ref_3 AS "CLIENT REF3",
TO_CHAR(account.assigned_date, 'MM/DD/YYYY') AS "ASSIGNED DATE",
account.assigned_balance AS "Currency:TOTAL ASSIGNED BALANCE",
(COALESCE(account.interest_owing, 0) - COALESCE(account.interest_assigned, 0)) AS "Currency:INTEREST ACCRUED",
account.principal_received AS "Currency:PRINCIPAL RECEIVED",
account.interest_received AS "Currency:INTEREST RECEIVED",
account.cancelled_balance AS "Currency:CANCELLED BALANCE",
account.current_balance AS "Currency:TOTAL BALANCE",
TO_CHAR(account.last_pay_date, 'MM/DD/YYYY') AS "LAST PAYMENT DATE",
debt_status_code.description AS "STATUS CODES",
account.cancelled AS "CANCELLED DATE"

FROM 
account

INNER JOIN debt_status_code On account.debt_status_code = debt_status_code.debt_status_code
LEFT JOIN client_data On account.debt_id=client_data.debt_id
WHERE
account.client_id In (${ClientCodes:ClientCode})
--account.customer_client_code = '${String:ClientCode}'
AND account.assigned_date BETWEEN ${DateRange:Assigned Date}
--ORDER BY account.last_pay_date DESC;