WITH numbered_statuses AS (
    SELECT
        debt.debt_id,
        debt.reference_number,
        debt.customer_client_code,
        debt.debt_status_code,
        ROW_NUMBER() OVER (PARTITION BY debt.debt_status_code ORDER BY debt.create_date) as row_num
    FROM debt
    WHERE debt.client_id IN (SELECT client_id FROM client_categories WHERE (UPPER(client_categories.prev_sys) != 'ANITA' OR client_categories.first_party IS TRUE))
)

SELECT debt_id,reference_number,customer_client_code,debt_status_code FROM numbered_statuses WHERE row_num <= 2;